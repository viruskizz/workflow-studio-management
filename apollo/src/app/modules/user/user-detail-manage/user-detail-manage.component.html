<div *ngIf="isStandalone" class="card">
    <div class="flex justify-content-between align-items-center mb-4">
        <h2>{{ isPatch ? "Edit User" : "Create User" }}</h2>
        <div class="flex gap-2">
            <p-button
                icon="pi pi-times"
                [rounded]="true"
                [text]="true"
                [raised]="true"
                severity="secondary"
                (click)="onCancel()"
            ></p-button>
            <p-button
                icon="pi pi-save"
                [rounded]="true"
                [text]="true"
                [raised]="true"
                severity="success"
                (click)="onSave()"
            ></p-button>
        </div>
    </div>

    <div class="card-content">
        <!-- Form content -->
        <form
            [formGroup]="userForm"
            class="flex flex-column align-items-center"
        >
            <div class="flex flex-column align-items-center mb-5">
                <img
                    [src]="imagePreview || 'assets/images/noimage.jpg'"
                    [alt]="user?.username || 'User avatar'"
                    width="150"
                    class="mt-0 mx-auto mb-3 block shadow-2 border-circle"
                />
                <h3 class="text-xl font-medium m-0">
                    {{ username?.value || "User" }}
                </h3>
                <p-fileUpload
                    mode="basic"
                    name="avatar"
                    accept="image/*"
                    [maxFileSize]="1000000"
                    styleClass="p-button-outlined p-button-plain mt-3"
                    chooseLabel="Upload Image"
                    (onSelect)="onSelectImage($event)"
                ></p-fileUpload>
            </div>

            <!-- <div class="field w-full text-center">
                <label for="username">Username*</label>
                <input formControlName="username" type="text" pInputText id="username" class="w-10"/>
                <small class="p-error" *ngIf="username?.errors?.['required'] && username?.touched">Username is required.</small>
                <small class="p-error" *ngIf="username?.errors?.['minlength'] && username?.touched">Username must be at least 6 characters.</small>
            </div>
            
            <div class="field w-full text-center" *ngIf="!isPatch">
                <label for="password">Password*</label>
                <input formControlName="password" type="password" pInputText id="password" class="w-10"/>
                <small class="p-error" *ngIf="password?.errors?.['required'] && password?.touched">Password is required.</small>
                <small class="p-error" *ngIf="password?.errors?.['minlength'] && password?.touched">Password must be at least 6 characters.</small>
            </div>
             -->
            <h5 class="text-center mt-5 mb-3">ABOUT</h5>
            <div class="field text-center flex align-items-center mb-5">
                <i class="pi pi-id-card mb-2 mr-3"></i>
                <p-dropdown
                    formControlName="role"
                    [options]="roles"
                    optionLabel="label"
                    optionValue="value"
                    placeholder="Select a role"
                    [showClear]="true"
                    id="role"
                    class="w-10"
                ></p-dropdown>
                <small
                    class="p-error"
                    *ngIf="role?.errors?.['required'] && role?.touched"
                    >Role is required.</small
                >
            </div>

            <h5 class="text-center mb-3">CONTACT</h5>
            <div class="field text-center flex align-items-center mb-5">
                <i class="pi pi-envelope mb-2 mr-3"></i>
                <input
                    formControlName="email"
                    type="text"
                    pInputText
                    id="email"
                    placeholder="email@example.com"
                    class="w-10"
                />
                <small
                    class="p-error"
                    *ngIf="email?.errors?.['required'] && email?.touched"
                    >Email is required.</small
                >
                <small
                    class="p-error"
                    *ngIf="email?.errors?.['email'] && email?.touched"
                    >Email is invalid format.</small
                >
            </div>

            <h5 class="text-center mb-3">TEAMS</h5>
            <div
                class="field w-full text-center flex flex-column align-items-center"
            >
                <i class="pi pi-users mb-2"></i>
                <div *ngIf="userTeams?.length; else noTeams">
                    <div
                        *ngFor="let team of userTeams?.slice(0, 3)"
                        class="flex align-items-center mb-2"
                    >
                        <p-avatar
                            [image]="team.imageUrl || ''"
                            shape="circle"
                            size="normal"
                            class="mr-2"
                        ></p-avatar>
                        <span>{{ team.name }}</span>
                        <span class="text-xs text-color-secondary ml-2"
                            >{{
                                (team.members && team.members.length) || 0
                            }}
                            members</span
                        >
                    </div>
                </div>
                <ng-template #noTeams>
                    <span class="text-sm text-500">No teams assigned</span>
                </ng-template>
            </div>
        </form>
    </div>
</div>
